<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Admin - V√Ωbƒõr fotky</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="config.js"></script>
    <style>
        body { font-family: sans-serif; background: #f4f4f4; padding: 20px; }
        .admin-box { background: white; max-width: 600px; margin: 0 auto; padding: 20px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 12px; margin: 10px 0; box-sizing: border-box; border: 1px solid #ddd; border-radius: 5px; }
        
        .gallery-title { margin-top: 20px; color: #555; font-size: 0.9em; text-transform: uppercase; letter-spacing: 1px; }
        .gallery { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); 
            gap: 15px; 
            margin: 10px 0 20px 0; 
            border: 2px solid #f0f0f0; 
            padding: 15px; 
            max-height: 400px; 
            overflow-y: auto; 
            background: #fafafa;
            border-radius: 8px;
        }
        .gallery img { 
            width: 100%; 
            height: 100px; 
            object-fit: cover; 
            cursor: pointer; 
            border-radius: 6px; 
            border: 4px solid transparent; 
            transition: 0.2s;
            background: white;
        }
        .gallery img:hover { border-color: #007bff; transform: scale(1.02); }
        .gallery img.selected { border-color: #28a745; box-shadow: 0 0 10px rgba(40,167,69,0.5); }

        .btn { background: #28a745; color: white; border: none; padding: 15px; width: 100%; border-radius: 5px; cursor: pointer; font-size: 1.1em; font-weight: bold; }
        .btn:hover { background: #218838; }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
        
        #selected-text { background: #e9ecef; padding: 10px; border-radius: 5px; text-align: center; }
    </style>
</head>
<body>

<div class="admin-box">
    <h1 style="text-align: center;">üõí Spr√°va svetr≈Ø</h1>
    
    <label>N√°zev produktu:</label>
    <input type="text" id="name" placeholder="Nap≈ô. Modr√Ω vlnƒõn√Ω svetr">
    
    <label>Cena (Kƒç):</label>
    <input type="number" id="price" placeholder="Nap≈ô. 1290">
    
    <h3 class="gallery-title">1. Vyber fotku kliknut√≠m:</h3>
    <div class="gallery" id="gallery">
        </div>

    <p id="selected-text">Vybran√° fotka: <b>≈æ√°dn√°</b></p>
    
    <button class="btn" onclick="ulozSvetr()" id="saveBtn">üöÄ Ulo≈æit a vystavit na web</button>
    <p id="status" style="text-align:center; font-weight:bold; margin-top: 15px;"></p>
    
    <div style="text-align: center; margin-top: 20px;">
        <a href="index.html" style="color: #007bff; text-decoration: none;">‚Üê P≈ôej√≠t na e-shop</a>
    </div>
</div>

<script>
    // Tady napi≈° n√°zvy soubor≈Ø, kter√© jsi nahr√°l na GitHub
    // Pokud nahraje≈° dal≈°√≠, prostƒõ je dopi≈° do seznamu
    const mojeFotky = [
        '01.png', 
        '03.png'
    ];

    // CESTA: Pokud m√°≈° fotky v hlavn√≠m seznamu, nech jen "". 
    // Pokud jsou ve slo≈æce fotky/fotky/, napi≈° to tam.
    const slozka = "fotky/fotky/"; 
    
    let vybranaFotka = "";

    const galleryDiv = document.getElementById('gallery');
    
    // Naƒçten√≠ galerie
    mojeFotky.forEach(foto => {
        const img = document.createElement('img');
        // P≈ôid√°me n√°hodn√© ƒç√≠slo za n√°zev, aby se obr√°zek poka≈æd√© ƒçerstvƒõ naƒçetl (prevence mezipamƒõti)
        img.src = slozka + foto;
        img.alt = foto;
        
        img.onclick = function() {
            document.querySelectorAll('.gallery img').forEach(i => i.classList.remove('selected'));
            img.classList.add('selected');
            
            vybranaFotka = slozka + foto;
            document.getElementById('selected-text').innerHTML = "Vybran√° fotka: <b style='color:#28a745'>" + foto + "</b>";
        };
        
        // Pokud se obr√°zek nenaƒçte, vyp√≠≈°e chybu do konzole
        img.onerror = function() {
            console.error("Nepoda≈ôilo se naƒç√≠st obr√°zek: " + img.src);
        };
        
        galleryDiv.appendChild(img);
    });

    function ulozSvetr() {
        const name = document.getElementById('name').value;
        const price = document.getElementById('price').value;
        const status = document.getElementById('status');
        const btn = document.getElementById('saveBtn');

        if (!name || !price || !vybranaFotka) {
            alert("‚ùå Pros√≠m vypl≈à n√°zev, cenu a vyber fotku!");
            return;
        }

        btn.disabled = true;
        status.style.color = "orange";
        status.innerText = "‚è≥ Odes√≠l√°m do datab√°ze...";
        
        db.ref('produkty').push({
            jmeno: name,
            cena: price,
            img: vybranaFotka
        }).then(() => {
            status.style.color = "green";
            status.innerHTML = "‚úÖ Svetr byl √∫spƒõ≈°nƒõ vystaven!";
            
            // Resetov√°n√≠ formul√°≈ôe
            document.getElementById('name').value = "";
            document.getElementById('price').value = "";
            document.querySelectorAll('.gallery img').forEach(i => i.classList.remove('selected'));
            document.getElementById('selected-text').innerHTML = "Vybran√° fotka: <b>≈æ√°dn√°</b>";
            vybranaFotka = "";
            btn.disabled = false;
        }).catch(err => {
            status.style.color = "red";
            status.innerText = "‚ùå Chyba p≈ôi ukl√°d√°n√≠: " + err.message;
            btn.disabled = false;
        });
    }
</script>

</body>
</html>
